{"id": "payload_000005", "important": {"title": "Account Takeover - Password Reset Flaws", "category": "Account Takeover", "sub_category": "Password Reset Vulnerabilities", "tags": ["password-reset", "token", "referrer", "poisoning", "parameter-pollution", "username-collision"], "targets": {"os": ["Any"], "system": ["Web App", "Password Reset Flow", "Email Services"]}, "risk": "critical"}, "variants": [{"match": {"os": ["Any"], "system": ["Web App"]}, "payload": "Request password reset for victim, click reset link, visit 3rd-party site while token present in Referer header; intercept traffic to read token.", "notes": "Password reset token leaked via Referer when user visits external site while token present in URL."}, {"match": {"os": ["Any"], "system": ["Web App"]}, "payload": "Intercept POST /reset.php and modify Host/X-Forwarded-Host to attacker.com to poison reset link generation to attacker-controlled domain.", "notes": "Password reset poisoning via Host or X-Forwarded-Host header; attacker hosts token link."}, {"match": {"os": ["Any"], "system": ["Web App"]}, "payload": "email=victim@mail.com&email=hacker@mail.com", "notes": "Parameter pollution in reset endpoint can send reset to attacker-controlled email."}, {"match": {"os": ["Any"], "system": ["Web App"]}, "payload": "Register username with trailing/leading whitespace identical to victim (e.g., \"admin \"), request reset, use token to take over victim account.", "notes": "Username collision due to trimming/normalization issues (example: CVE-2020-7245 on CTFd)."}], "usage": {"steps": ["Trigger password reset for target account (via UI or API).", "Observe server responses and reset link generation/headers.", "Intercept/reset link or manipulate host/email parameters as applicable.", "Use obtained token to reset password and authenticate as victim."], "required_params": {"target_email": {"required": true, "example": "victim@mail.com"}, "reset_endpoint": {"required": false, "example": "https://example.com/api/v1/password/reset"}}, "mitigations": ["Do not include tokens in URLs where Referer may leak them; use POST bodies and one-time short-lived tokens.", "Canonicalize and normalize usernames strictly; trim and reject confusing unicode/whitespace variants.", "Validate Host header usage and avoid blindly using forwarded host for link generation.", "Enforce token expiry, uniqueness, and single-use semantics; store server-side state to prevent reuse."], "references": ["CTFd Account Takeover - NIST NVD - March 29, 2020", "CVE-2020-7245"]}, "system": {"version": "2.0.0", "source": "PayloadsAllTheThings"}}
