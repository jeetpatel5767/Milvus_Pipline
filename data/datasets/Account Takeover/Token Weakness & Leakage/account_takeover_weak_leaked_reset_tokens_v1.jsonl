{"id": "payload_000006", "important": {"title": "Account Takeover - Weak & Leaked Reset Tokens", "category": "Account Takeover", "sub_category": "Token Weakness & Leakage", "tags": ["token", "weak-rng", "predictable", "replay", "leakage", "logs"], "targets": {"os": ["Any"], "system": ["Authentication Service", "Password Reset Service"]}, "risk": "critical"}, "variants": [{"match": {"os": ["Any"], "system": ["Auth Service"]}, "payload": "Analyze resetToken values for patterns: fixed value, timestamp-based, userID-derived, short numeric tokens (<6 chars).", "notes": "Weak token generation can be guessed or brute-forced."}, {"match": {"os": ["Any"], "system": ["Auth Service"]}, "payload": "Trigger reset API for test@mail.com and inspect API response for resetToken field; use token in /password/reset?resetToken=[TOKEN]&email=[MAIL].", "notes": "Some APIs return tokens in response bodies or logs â€” a leakage vector."}], "usage": {"steps": ["Trigger multiple reset requests to observe token generation behavior.", "Collect tokens and analyze for predictability or reuse.", "Attempt to construct valid tokens from observed patterns or brute force if entropy is low.", "Use discovered token to reset victim password."], "required_params": {"api_reset_call": {"required": false, "example": "POST /api/v3/user/password/reset"}, "observed_token": {"required": false, "example": "abc123DEF"}}, "mitigations": ["Generate cryptographically secure random tokens with sufficient entropy.", "Set short expiry, single-use tokens, and limit reset attempts / rate-limit per account/IP.", "Avoid returning tokens in API responses; never log tokens in plaintext."], "references": ["10 Password Reset Flaws - Anugrah SR - September 16, 2020", "Broken Cryptography & Account Takeovers - Harsh Bothra - September 20, 2020"]}, "system": {"version": "2.0.0", "source": "PayloadsAllTheThings"}}
