{"id": "payload_000003", "important": {"title": "API Key and Token Leaks - Docker Images & Config Files", "category": "Credential Exposure", "sub_category": "API Keys and Tokens", "tags": ["api", "token", "docker", "secrets", "logs"], "targets": {"os": ["Any"], "system": ["Docker Images", "Configuration Files", "Logs"]}, "risk": "high"}, "variants": [{"match": {"os": ["Any"], "system": ["Docker Images"]}, "payload": "docker run --rm -it -v \"$PWD:/pwd\" trufflesecurity/trufflehog:latest docker --image trufflesecurity/secrets", "notes": "Scan a Docker image for verified secrets"}, {"match": {"os": ["Any"], "system": ["Config Files"]}, "payload": "Check .env, config.json, settings.py, or .aws/credentials for hardcoded keys", "notes": "Config files often leak sensitive API tokens"}], "usage": {"steps": ["Identify target Docker image or config files", "Run TruffleHog on the Docker image", "Manually inspect logs/configs for secrets"], "required_params": {"docker_image": {"required": false, "example": "trufflesecurity/secrets"}, "config_file": {"required": false, "example": ".env"}}, "mitigations": ["Do not hardcode credentials in images/configs", "Use secret management solutions (Vault, AWS Secrets Manager)"], "references": ["https://trufflesecurity.com", "https://12factor.net/config"]}, "system": {"version": "2.0.0", "source": "PayloadsAllTheThings"}}
